let wxopen = {}

let base = "https://open.weixin.qq.com";

wxopen.index = base + "/cgi-bin/index?t=home/index&lang=zh_CN"

wxopen.login = base + "/cgi-bin/login"

wxopen.list =  function (token){
    return base + "/cgi-bin/applist?t=manage/list&page=0&num=20&openapptype=2048&token=" +token+"&lang=zh_CN";
}

wxopen.one = function (token,appid) {
    return base + "/wxaopen/serviceprovider/"+appid+"?token="+token;
}


wxopen.modify = function (token,appid) {
    return base + "/cgi-bin/component_acct?action=modify&t=manage/plugin_modify&appid="+appid+"&token="+token;
}

wxopen.create = function (token) {
    return base + "/cgi-bin/component_acct?t=manage/createBizPlugin&action=create&lang=zh_CN&token=" + token;
}

wxopen.component_acct = function () {
    return base + "/cgi-bin/component_acct"
}

wxopen.direct_modify = function (token,appid) {
    return base + "/cgi-bin/component_acct?action=detail&t=manage/plugin_detail&token="+token+"&appid="+appid;
}

wxopen.downloadTxt = function(token){
    return base + "/cgi-bin/component_acct?action=download_confirmfile&token="+token+"&lang=";
}

wxopen.doSecret = function(token,appid){
    return base + "/wxaopen/serviceprovider/"+appid+"?token="+token;
}

wxopen.authqr = function(){
    return base + "/cgi-bin/authqr"
}

wxopen.qrcode = function(token,tiket){
    return base + "/cgi-bin/authqr?action=getqrcode&qrcheck_ticket="+tiket+"&size120&token="+token;
}

wxopen.secret = function(){
    return base + "/cgi-bin/appdetail"
}

wxopen.browserIndex = {
    "User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36",
    "accept-language":"zh-CN,zh;q=0.9,en;q=0.8,pt;q=0.7",
    "accept":"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3",
    "accept-encoding": "gzip, deflate, br"
}

wxopen.browserCookie = function (cookie) {

    let ck = {
        "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36",
        "accept-language": "zh-CN,zh;q=0.9,en;q=0.8,pt;q=0.7",
        "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3",
        "accept-encoding": "gzip, deflate, br",
        "cookie": cookie
    }
    return ck
}

wxopen.browserBase = function (cookie,referer) {
    let ck = {
        "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36",
        "accept-language": "zh-CN,zh;q=0.9,en;q=0.8,pt;q=0.7",
        "accept": "application/json, text/javascript, */*; q=0.01",
        "accept-encoding": "gzip, deflate, br",
        "x-requested-with": "XMLHttpRequest",
        "content-type": "application/x-www-form-urlencoded; charset=UTF-8",
        "referer": referer,
        "cookie": cookie
    }

    return ck
}

wxopen.createCookie = function (res) {
    let list = res.headers['set-cookie'].map( d =>{
        return d.split(";")[0]
    })

    let one = '';

    for (let k in list){
        one = one + list[k] + "; "
    }

    return one
}

module.exports = wxopen