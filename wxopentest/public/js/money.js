Vue.prototype.$echarts = window.echarts

Vue.component("moneyhome",{
   template:"#moneyhome-template",
   data(){
     return {
       time:moment().format("YYYY-MM-DD"),
       ordertotal:0,
       splittotal:0,
       cashTotal:0,
       packTotal:0,
       splitbase:0,
       mymoney:0,
       loading:false,
     }
   },
   mounted:function () {
     this.loading = true
     let that = this
     let href = window.location.href + "/geteveryday"
     this.postData(href,{time:this.time},function (res) {
        let dt = res.data
        if(dt.code == 200){

             let dt = res.data;
             that.ordertotal = (dt.ordertotal/100).toFixed(2);
             that.splittotal = (dt.splittotal/100).toFixed(2);
             that.cashTotal =  (dt.cashTotal/100).toFixed(2);
             that.packTotal =  (dt.packTotal/100).toFixed(2);
             that.splitbase =  (dt.splitbase/100).toFixed(2);
             that.mymoney = ((dt.ordertotal - dt.splittotal - dt.packTotal - dt.splitbase)/100).toFixed(2)

        }//-----code == 200 over
        that.loading = false;
     })
   },
   methods:{
      postData:function(href,data,callback){
         axios.post(href,data).then(function (res) {
            console.log(res)
            callback(res)
         }).catch(function (e) {
            console.log(e)
         })
      },
      changeDate:function(val){
        let t = moment(val).format("YYYY-MM-DD")
        let old = moment(this.time).format("YYYY-MM-DD")
        this.loading = true
        if(t.indexOf("-") > 0) {
          let that = this
          let href = window.location.href + "/geteveryday"
          this.postData(href, {time:t},function (res) {
             let dt = res.data;
             if(dt.code == 200){
                  that.ordertotal = (dt.ordertotal/100).toFixed(2);
                  that.splittotal = (dt.splittotal/100).toFixed(2);
                  that.cashTotal =  (dt.cashTotal/100).toFixed(2);
                  that.packTotal =  (dt.packTotal/100).toFixed(2);
                  that.splitbase =  (dt.splitbase/100).toFixed(2);
                  that.mymoney = ((dt.ordertotal - dt.splittotal - dt.packTotal - dt.splitbase)/100).toFixed(2)
                  that.setMyChart(that.ordertotal,that.splittotal,that.cashTotal,that.splitbase,that.packTotal,that.mymoney)
             }//-----code == 200 over
             that.loading = false
          })
        }
      },
  },
})
